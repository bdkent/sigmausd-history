(this["webpackJsonpsigmausd-history"]=this["webpackJsonpsigmausd-history"]||[]).push([[0],{194:function(e,t,n){},195:function(e,t,n){},370:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),i=n(39),c=n.n(i),o=(n(194),n(100)),s=n(15),u=n(26),l=(n(195),n(136),n(23)),b=n(183),m=n.n(b),j=n(132),f=n.n(j);function d(){var e=l.DateTime.now().toUTC();return{start:O(e.minus({hours:12})),end:O(e)}}function O(e){return l.DateTime.utc(e.year,e.month,e.day)}function h(){return O(l.DateTime.now().toUTC())}function v(e){var t=e.toUTC();return"".concat(t.year,"-").concat(f()(t.month.toString(),2,"0"),"-").concat(f()(t.day.toString(),2,"0"))}var p=n(9),x=n.n(p),g=n(22),y=n(187),C=n(374),S=n(214),k=n(216).default,T=new S.Connection(new Worker(k));function D(e){return R.apply(this,arguments)}function R(){return(R=Object(g.a)(x.a.mark((function e(t){var n,r,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=v(t),r="".concat("/sigmausd-history","/data/daily/").concat(n,".json"),e.next=4,fetch(r);case 4:return a=e.sent,e.next=7,a.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(){return(w=Object(g.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.initDb({name:"sigmausd",tables:[{name:"Items",columns:{id:{primaryKey:!0,dataType:"number"},time:{notNull:!0,dataType:"string"},reserveRatio:{notNull:!0,dataType:"string"},stableCoinPrice:{notNull:!0,dataType:"string"},stableCoinRatio:{notNull:!0,dataType:"string"},reserveCoinPrice:{notNull:!0,dataType:"string"},reserveCoinRatio:{notNull:!0,dataType:"string"}}}]});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(){return(M=Object(g.a)(x.a.mark((function e(t){var n,r,a,i,c,o;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.toUTC(),r=h(),a=r.equals(n)){e.next=10;break}return i=n.plus({days:1}).minus({minutes:5}),e.next=7,T.select({from:"Items",where:{id:{"-":{low:n.toMillis(),high:i.toMillis()}}}});case 7:if(!((c=e.sent).length>0)){e.next=10;break}return e.abrupt("return",c);case 10:return e.next=12,D(n);case 12:if(o=e.sent,a){e.next=16;break}return e.next=16,T.insert({into:"Items",upsert:!0,values:o.map((function(e){return Object(s.a)(Object(s.a)({},e),{},{id:l.DateTime.fromISO(e.time).toMillis()})}))});case 16:return e.abrupt("return",o);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e){return new C.a((function(t){var n=new y.a({concurrency:2});n.on("completed",(function(e){t.next(e)})),n.on("error",(function(e){t.error(e)})),n.addAll(e.map((function(e){return function(){return function(e){return M.apply(this,arguments)}(e).then((function(t){return[e,t]}))}}))).then((function(){return t.complete()}))}))}!function(){w.apply(this,arguments)}();var P=n(4),I=Object(r.memo)((function(){var e,t=null===(e=document.querySelector("meta[name=tip]"))||void 0===e?void 0:e.content,n=(null===t||void 0===t?void 0:t.includes("REACT_APP_TIP"))?void 0:t;return Object(P.jsx)("footer",{className:"navbar navbar-expand-lg navbar-light bg-light",children:Object(P.jsxs)("div",{className:"container-fluid",children:[Object(P.jsx)("ul",{className:"navbar-nav",children:Object(P.jsx)("li",{className:"nav-item",children:Object(P.jsx)("a",{href:"http://sigmausd.io",className:"nav-link",target:"_blank",rel:"noreferrer",children:"sigmausd.io"})})}),n&&Object(P.jsx)("a",{href:"https://explorer.ergoplatform.com/en/addresses/".concat(n),target:"_blank",rel:"noreferrer",children:"\u2665 donations"})]})})})),A=n(185),F=n.n(A),J=["reserveRatio","stable","reserve"],H={reserveRatio:"Reserve Ratio (%)",stable:"SigmaUSD Ratio ($)",reserve:"SigmaRSV Ratio"},L={reserveRatio:function(e){return"".concat(e," %")},stable:function(e){return"$".concat(e)},reserve:function(e){return e}},U=Object(r.memo)((function(e){var t=e.pickerProps,n=e.column,r=e.onColumnChange,a=e.onRangeChange;return Object(P.jsxs)("div",{className:"d-flex flex-wrap",children:[Object(P.jsx)("div",{className:"flex-fill",children:Object(P.jsx)(F.a,Object(s.a)(Object(s.a)({},t),{},{onChange:a,format:"MMM d, y"}))}),Object(P.jsx)("div",{className:"flex-fill",children:Object(P.jsx)("select",{value:n,className:"form-select",onChange:function(e){r(e.target.value)},children:J.map((function(e){return Object(P.jsx)("option",{value:e,children:H[e]},e)}))})})]})})),B=n(186),E=Object(r.memo)((function(e){var t=e.progress,n=e.dayCount,r=e.onComplete;return Object(P.jsx)(B.a,{color:"#f11946",progress:(n-t)/n*100,onLoaderFinished:r})})),_=Object(r.memo)((function(){return Object(P.jsx)("a",{className:"github-fork-ribbon",href:"https://github.com/bdkent/sigmausd-history","data-ribbon":"Fork me on GitHub",title:"Fork me on GitHub",target:"_blank",rel:"noreferrer",children:"Fork me on GitHub"})})),q=n(32),W=n(20),G=Object(r.memo)((function(e){var t=e.pickerProps,n=e.timeSeriesData,a=e.column,i=e.chartRowHeight,c=Object(r.useState)(),o=Object(u.a)(c,2),l=o[0],b=o[1],m=Object(r.useState)(),j=Object(u.a)(m,2),f=j[0],d=j[1],O=Object(r.useState)(),h=Object(u.a)(O,2),v=(h[0],h[1]),p=Object(r.useMemo)((function(){return new W.TimeRange(n.start,n.end)}),[n]),x=Object(r.useState)(p),g=Object(u.a)(x,2),y=g[0],C=g[1];Object(r.useEffect)((function(){C(p)}),[t,n,p]);var S=Object(r.useCallback)((function(e,t){return v(e&&t?[e,t]:void 0)}),[]),k=Object(r.useCallback)((function(e){b(e),e||v(void 0)}),[]),T=Object(r.useCallback)((function(e){return d(e)}),[]),D=Object(r.useMemo)((function(){return l?{event:n.timeSeries.atTime(l),info:[{label:H[a],value:L[a]("".concat(n.timeSeries.atTime(l).get(a)))}]}:void 0}),[n,l,a]),R=Object(r.useMemo)((function(){return["time",a]}),[a]);return Object(P.jsx)(q.Resizable,{children:Object(P.jsx)(q.ChartContainer,{timeRange:y,maxTime:t.maxDate,minTime:t.minDate,timeAxisAngledLabels:!0,timeAxisHeight:65,onMouseMove:S,enablePanZoom:!0,onTimeRangeChanged:C,onTrackerChanged:k,minDuration:36e5,children:Object(P.jsxs)(q.ChartRow,{height:i,children:[Object(P.jsx)(q.YAxis,{id:"y",label:H[a],min:n.timeSeries.min(a,(function(e){return e})),max:n.timeSeries.max(a),width:"60",type:"linear"}),Object(P.jsxs)(q.Charts,{children:[Object(P.jsx)(q.Baseline,{axis:"y",value:400,label:"400%",position:"left"}),Object(P.jsx)(q.Baseline,{axis:"y",value:800,label:"800%",position:"left"}),Object(P.jsx)(q.LineChart,{axis:"y",breakLine:!1,series:n.timeSeries,columns:R,selection:f,onSelectionChange:T,interpolation:"curveBasis",timeScale:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.log("WOW",t)}}),l?Object(P.jsx)(q.EventMarker,Object(s.a)(Object(s.a)({},D),{},{type:"flag",axis:"y",infoWidth:180,column:a,markerRadius:3,markerStyle:{fill:"black"}})):Object(P.jsx)(z,{}),Object(P.jsx)("g",{})]})]})})})})),z=Object(r.memo)((function(){return Object(P.jsx)("g",{})})),$=n(73),K=n(134),V=n.n(K),Y=l.DateTime.utc(2021,5,9,13,38),Z=function(){var e,t,n=Object(r.useState)({}),a=Object(u.a)(n,2),i=a[0],c=a[1],b=Object(r.useState)(d()),j=Object(u.a)(b,2),f=j[0],h=j[1],p=Object(r.useState)(0),x=Object(u.a)(p,2),g=x[0],y=x[1],C=Object(r.useCallback)((function(){return y(0)}),[]),S=Object(r.useCallback)((function(e,t){c((function(n){return Object(s.a)(Object(s.a)({},n),{},Object(o.a)({},e,t))}))}),[]),k=Object(r.useMemo)((function(){return O(f.end).diff(O(f.start),"days").days+1}),[f]);Object(r.useEffect)((function(){var e=m()(k);y(e.length),N(e.map((function(e){return f.start.plus({days:e})}))).subscribe((function(e){var t=Object(u.a)(e,2),n=t[0],r=t[1];S(v(n),r),y((function(e){return e-1}))}))}),[S,f,k]);var T=Object(r.useCallback)((function(e){if(e){var t=Object(u.a)(e,2),n=t[0],r=t[1];c({}),h((function(e){var t=l.DateTime.fromJSDate(n),a=l.DateTime.fromJSDate(r);return t.equals(e.start)&&a.equals(e.end)?e:{start:t,end:a}}))}else c({}),h(d())}),[]),D=function(e){return Object(r.useMemo)((function(){var t,n,r=V()(Object.keys(e)).reduce((function(t,n){var r;return[].concat(Object($.a)(t),Object($.a)(null!==(r=e[n])&&void 0!==r?r:[]))}),[]),a=Math.max(Math.ceil(r.length/5e3),1),i=r.reduce((function(e,t,n){if(n%a===0){var r=l.DateTime.fromISO(t.time);return[].concat(Object($.a)(e),[[r.toJSDate(),parseInt(t.reserveRatio,10),Math.round(100*parseFloat(t.stableCoinRatio))/100,parseInt(t.reserveCoinRatio,10),r.toMillis()]])}return e}),[]);if(null===i||void 0===i?void 0:i.length){var c=V()(i,(function(e){return e[4]}));return{start:null===(t=c[0])||void 0===t?void 0:t[0],end:null===(n=c[c.length-1])||void 0===n?void 0:n[0],timeSeries:new W.TimeSeries({name:"Data",columns:["time"].concat(Object($.a)(J)),points:c})}}}),[e])}(i),R=Object(r.useMemo)((function(){return{value:[f.start.toJSDate(),f.end.toJSDate()],maxDate:l.DateTime.now().toJSDate(),minDate:Y.toJSDate()}}),[f]),w=Object(r.useRef)(null),M=Object(r.useState)("reserveRatio"),A=Object(u.a)(M,2),F=A[0],H=A[1];return Object(P.jsxs)("div",{className:"App container min-vh-100",children:[Object(P.jsx)(E,{progress:g,dayCount:k,onComplete:C}),Object(P.jsx)(_,{}),Object(P.jsxs)("div",{className:"d-flex flex-column min-vh-100",children:[Object(P.jsxs)("div",{children:[Object(P.jsx)("h1",{children:"SigmaUSD History"}),Object(P.jsx)(U,{pickerProps:R,column:F,onColumnChange:H,onRangeChange:T}),Object(P.jsx)("hr",{})]}),Object(P.jsx)("div",{className:"flex-grow-1 ",ref:w,children:D&&D.timeSeries.size()>0?Object(P.jsx)(G,{column:F,timeSeriesData:D,pickerProps:R,chartRowHeight:.75*(null!==(e=null===(t=w.current)||void 0===t?void 0:t.offsetHeight)&&void 0!==e?e:400)}):Object(P.jsx)("p",{children:"No data available for given time range."})}),Object(P.jsxs)("div",{children:[Object(P.jsx)("hr",{}),Object(P.jsx)(I,{})]})]})]})},Q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,375)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),i(e),c(e)}))};c.a.render(Object(P.jsx)(a.a.StrictMode,{children:Object(P.jsx)(Z,{})}),document.getElementById("root")),Q()}},[[370,1,2]]]);
//# sourceMappingURL=main.bbaa6be3.chunk.js.map